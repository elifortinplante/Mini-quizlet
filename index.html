<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini Quizlet</title>
<style>
  body { margin:0; font-family:Arial, sans-serif; background:#f2f6ff; }
  header { background:#4a6cf7; color:#fff; padding:1rem; text-align:center; }
  main { padding:1rem; }
  button { background:#4a6cf7; color:#fff; border:none; padding:0.6rem 1rem; border-radius:8px; margin:0.3rem; cursor:pointer; }
  button:hover { background:#3451c5; }
  .set-card { background:#fff; padding:1rem; border-radius:12px; margin:0.5rem 0; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
  .hidden { display:none; }
  .flashcard { width:90%; max-width:320px; height:200px; margin:2rem auto; perspective:1000px; position:relative; }
  .card-inner { width:100%; height:100%; position:absolute; transition: transform 0.6s; transform-style: preserve-3d; }
  .card.flipped .card-inner { transform: rotateY(180deg); }
  .card-front, .card-back { position:absolute; width:100%; height:100%; backface-visibility:hidden; display:flex; align-items:center; justify-content:center; border-radius:12px; font-size:1.2rem; box-shadow:0 2px 8px rgba(0,0,0,0.2); background:#fff; }
  .card-back { transform: rotateY(180deg); }
  #study-area { text-align:center; }
  #score { font-size:1.2rem; margin:1rem; color:goldenrod; }
</style>
</head>
<body>

<header>
  <h1>Mini Quizlet</h1>
  <button onclick="resetData()">üîÑ Reset Data</button>
</header>

<main>
  <!-- Page d'accueil -->
  <section id="home">
    <h2>Mes sets</h2>
    <div id="sets-list"></div>
    <button onclick="showCreateSet()">+ Nouveau set</button>
  </section>

  <!-- Cr√©ation/√©dition -->
  <section id="create" class="hidden">
    <h2 id="create-title">Cr√©er un set</h2>
    <input id="set-subject" placeholder="Mati√®re"><br><br>
    <input id="set-name" placeholder="Nom du quiz"><br><br>
    <div id="cards-editor"></div>
    <button onclick="addCardEditor()">+ Ajouter une carte</button><br><br>
    <button onclick="saveSet()">Enregistrer</button>
    <button onclick="backHome()">Annuler</button>
  </section>

  <!-- √âtude -->
  <section id="study" class="hidden">
    <h2 id="study-title"></h2>
    <div class="flashcard card" id="flashcard">
      <div class="card-inner">
        <div class="card-front" id="card-front"></div>
        <div class="card-back" id="card-back"></div>
      </div>
    </div>
    <div id="score"></div>
    <button onclick="markCard(true)">‚úÖ Bien</button>
    <button onclick="markCard(false)">‚ùå Mal</button>
    <button onclick="backHome()">üè† Home</button>
  </section>
</main>

<script>
let sets = JSON.parse(localStorage.getItem("quizletSets") || "[]");
let editIndex = null;
let studyCards = [];
let currentCard = 0;
let correct = 0;
let wrongCards = [];

function saveLocal(){
  try { localStorage.setItem("quizletSets", JSON.stringify(sets)); }
  catch(e){ alert("Erreur stockage: " + e); }
}

function resetData(){
  if(confirm("Effacer toutes les donn√©es ?")){
    localStorage.removeItem("quizletSets"); sets=[]; renderSets();
  }
}

function renderSets(){
  document.getElementById("home").classList.remove("hidden");
  document.getElementById("create").classList.add("hidden");
  document.getElementById("study").classList.add("hidden");
  const list=document.getElementById("sets-list"); list.innerHTML="";
  sets.forEach((s,i)=>{
    let div=document.createElement("div");
    div.className="set-card";
    div.innerHTML=`<b>${s.subject} - ${s.name}</b><br>
    <button onclick="editSet(${i})">Modifier</button>
    <button onclick="startStudy(${i})">Jouer</button>
    <button onclick="deleteSet(${i})">Supprimer</button>`;
    list.appendChild(div);
  });
}
renderSets();

function showCreateSet(){
  editIndex=null;
  document.getElementById("set-subject").value="";
  document.getElementById("set-name").value="";
  document.getElementById("cards-editor").innerHTML="";
  addCardEditor();
  document.getElementById("create-title").innerText="Cr√©er un set";
  document.getElementById("home").classList.add("hidden");
  document.getElementById("create").classList.remove("hidden");
}

function addCardEditor(q="",a=""){
  let div=document.createElement("div");
  div.innerHTML=`<input placeholder="Question" value="${q}" onfocus="if(this.value=='Question')this.value=''"> 
                 <input placeholder="R√©ponse" value="${a}" onfocus="if(this.value=='R√©ponse')this.value=''"> 
                 <button onclick="this.parentNode.remove()">üóëÔ∏è</button>`;
  document.getElementById("cards-editor").appendChild(div);
}

function saveSet(){
  const subject=document.getElementById("set-subject").value.trim();
  const name=document.getElementById("set-name").value.trim();
  if(!subject||!name){alert("Mati√®re et nom requis");return;}
  let cards=[];
  document.querySelectorAll("#cards-editor div").forEach(d=>{
    let q=d.children[0].value.trim(); let a=d.children[1].value.trim();
    if(q&&a) cards.push({q,a});
  });
  if(cards.length==0){alert("Ajoute au moins une carte");return;}
  let set={subject,name,cards};
  if(editIndex!=null) sets[editIndex]=set; else sets.push(set);
  saveLocal(); backHome();
}

function editSet(i){
  editIndex=i; let s=sets[i];
  document.getElementById("set-subject").value=s.subject;
  document.getElementById("set-name").value=s.name;
  document.getElementById("cards-editor").innerHTML="";
  s.cards.forEach(c=>addCardEditor(c.q,c.a));
  document.getElementById("create-title").innerText="Modifier set";
  document.getElementById("home").classList.add("hidden");
  document.getElementById("create").classList.remove("hidden");
}

function deleteSet(i){
  if(confirm("Supprimer ce set ?")){ sets.splice(i,1); saveLocal(); renderSets(); }
}

function backHome(){ renderSets(); }

function startStudy(i){
  studyCards=[...sets[i].cards]; currentCard=0; correct=0; wrongCards=[];
  document.getElementById("study-title").innerText=sets[i].subject+" - "+sets[i].name;
  document.getElementById("home").classList.add("hidden");
  document.getElementById("create").classList.add("hidden");
  document.getElementById("study").classList.remove("hidden");
  showCard();
}

function showCard(){
  if(currentCard>=studyCards.length){ endStudy(); return; }
  let c=studyCards[currentCard];
  document.getElementById("card-front").innerText=c.q;
  document.getElementById("card-back").innerText=c.a;
  document.getElementById("flashcard").classList.remove("flipped");
  document.getElementById("score").innerText=`Score: ${correct}/${studyCards.length}`;
}

document.getElementById("flashcard").addEventListener("click",()=>{
  document.getElementById("flashcard").classList.toggle("flipped");
});

function markCard(isCorrect){
  if(isCorrect) correct++; else wrongCards.push(studyCards[currentCard]);
  currentCard++; showCard();
}

function endStudy(){
  document.getElementById("score").innerText=`Fini! Score: ${correct}/${studyCards.length}`;
  document.getElementById("card-front").innerHTML=`
    <button onclick="retryAll()">üîÅ Recommencer tout</button><br>
    <button onclick="retryErrors()">‚ùå Refaire erreurs</button>`;
  document.getElementById("card-back").innerText="";
  document.getElementById("flashcard").classList.remove("flipped");
}

function retryAll(){ currentCard=0; correct=0; wrongCards=[]; showCard(); }
function retryErrors(){
  if(wrongCards.length==0){alert("Aucune erreur!");return;}
  studyCards=[...wrongCards]; currentCard=0; correct=0; wrongCards=[]; showCard();
}
</script>
</body>
</html>

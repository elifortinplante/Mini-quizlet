<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini-Quizlet Mobile</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { margin:0; font-family: system-ui, sans-serif; background: linear-gradient(135deg,#6366f1,#ec4899,#f59e0b); color:white; min-height:100vh; }
  .btn { padding:.7rem 1rem; border-radius:9999px; font-weight:700; }
  .btn-primary { background: linear-gradient(90deg,#6366f1,#ec4899); color:white; }
  .btn-secondary { background:white; color:#4f46e5; border:2px solid #4f46e5; }
  .input { width:100%; padding:.6rem .8rem; border-radius:14px; border:2px solid #e5e7eb; background:white; color:black; }
  .set-card { background:white; color:black; border-radius:20px; padding:14px; box-shadow:0 8px 24px rgba(0,0,0,.18); }
  .card { width:320px; max-width:90vw; height:220px; border-radius:28px; position:relative; box-shadow:0 12px 32px rgba(0,0,0,.25); margin-inline:auto; display:flex; align-items:center; justify-content:center; overflow:hidden; background-size:cover; background-position:center; color:white; text-shadow:0 2px 6px rgba(0,0,0,0.6); }
</style>
</head>
<body class="pb-20">
<header class="max-w-4xl mx-auto px-4 pt-5 flex items-center justify-between">
  <div class="flex items-center gap-3">
    <div class="w-11 h-11 rounded-2xl bg-white text-indigo-600 grid place-items-center font-extrabold">MQ+</div>
    <div>
      <h1 class="text-2xl font-extrabold drop-shadow">Mini-Quizlet Mobile</h1>
      <p class="text-indigo-100 text-sm -mt-1">√âtudier en s‚Äôamusant ‚ú®</p>
    </div>
  </div>
  <div class="flex items-center gap-2">
    <button id="btnNewSet" class="btn btn-primary">+ Nouveau set</button>
  </div>
</header>
<main class="max-w-4xl mx-auto px-4 pt-4">
  <section id="viewHome" class="space-y-4">
    <div id="setsGrid" class="grid grid-cols-1 sm:grid-cols-2 gap-4"></div>
    <p id="emptyMsg" class="text-center text-white/90 hidden">Aucun set. Cr√©e ton premier ‚ú®</p>
  </section>

  <section id="viewEditor" class="hidden">
    <div class="flex items-center justify-between mb-3">
      <button class="btn btn-secondary" id="btnBackHome">‚Üê Accueil</button>
    </div>
    <div class="grid sm:grid-cols-2 gap-3 mb-3">
      <div>
        <label class="text-sm font-bold">Titre du set</label>
        <input id="setTitle" class="input" placeholder="Ex: Vocabulaire anglais">
      </div>
      <div>
        <label class="text-sm font-bold">Mati√®re</label>
        <input id="setSubject" class="input" placeholder="Ex: Anglais">
      </div>
    </div>
    <div class="flex items-center justify-between mb-2">
      <h3 class="font-extrabold">Cartes</h3>
      <button id="btnAddCard" class="btn btn-primary">+ Ajouter</button>
    </div>
    <div id="cardsList" class="space-y-3"></div>
  </section>

  <section id="viewStudy" class="hidden">
    <div class="flex items-center justify-between mb-2">
      <button class="btn btn-secondary" id="btnBackHome2">‚Üê Accueil</button>
      <span id="progressChip" class="chip">0/0</span>
    </div>
    <div class="text-center mb-2">
      <div id="studySetTitle" class="text-xl font-extrabold"></div>
    </div>
    <div class="card" id="card">
      <div id="cardText" class="text-lg font-bold"></div>
    </div>
    <div class="mt-5 flex flex-wrap items-center justify-center gap-2">
      <button id="btnAgainWrong" class="btn btn-secondary">Reprendre erreurs</button>
      <button id="btnRestartAll" class="btn btn-primary">Tout recommencer</button>
    </div>
  </section>
</main>

<template id="tplSet">
  <div class="set-card p-4 flex items-center gap-3">
    <div class="flex-1">
      <div class="font-extrabold text-black/90 set-title">Titre</div>
      <div class="text-sm text-slate-500 set-subject">Mati√®re</div>
      <div class="text-xs text-slate-500 set-count">0 cartes</div>
    </div>
    <div class="flex flex-col gap-2">
      <button class="btn btn-primary btn-edit">Modifier</button>
      <button class="btn btn-primary btn-play">Jouer</button>
      <button class="btn btn-secondary btn-del">Supprimer</button>
    </div>
  </div>
</template>

<template id="tplCardRow">
  <div class="set-card p-3">
    <div class="grid grid-cols-1 gap-2">
      <input class="input input-front" placeholder="Question">
      <input class="input input-back" placeholder="R√©ponse">
      <input class="input input-img" placeholder="URL image">
      <button class="btn btn-secondary btn-del-card">üóëÔ∏è Carte</button>
    </div>
  </div>
</template>

<script>
const LS_KEY='mq_sets';
let sets=[]; let currentSetId=null; let study={order:[],i:0,wrong:[]};
const $=s=>document.querySelector(s);
function load(){sets=JSON.parse(localStorage.getItem(LS_KEY)||'[]');}
function save(){localStorage.setItem(LS_KEY,JSON.stringify(sets));}
function uid(){return Math.random().toString(36).slice(2,9);}
function findSet(id){return sets.find(s=>s.id===id);}
function upsertSet(s){const i=sets.findIndex(x=>x.id===s.id); if(i>-1) sets[i]=s; else sets.push(s); save();}

const viewHome=$('#viewHome'), viewEditor=$('#viewEditor'), viewStudy=$('#viewStudy'), setsGrid=$('#setsGrid'), cardsList=$('#cardsList');
function showHome(){viewHome.classList.remove('hidden');viewEditor.classList.add('hidden');viewStudy.classList.add('hidden'); renderHome();}
function showEditor(){viewHome.classList.add('hidden');viewEditor.classList.remove('hidden');viewStudy.classList.add('hidden'); renderEditor();}
function showStudy(){viewHome.classList.add('hidden');viewEditor.classList.add('hidden');viewStudy.classList.remove('hidden');}

function renderHome(){setsGrid.innerHTML=''; if(!sets.length){$('#emptyMsg').classList.remove('hidden'); return;} $('#emptyMsg').classList.add('hidden'); const tpl=$('#tplSet'); sets.forEach(s=>{const el=tpl.content.cloneNode(true); el.querySelector('.set-title').textContent=s.title||'Sans titre'; el.querySelector('.set-subject').textContent=s.subject||'‚Äî'; el.querySelector('.set-count').textContent=`${s.cards?.length||0} cartes`; el.querySelector('.btn-edit').onclick=()=>{currentSetId=s.id; showEditor();}; el.querySelector('.btn-play').onclick=()=>{currentSetId=s.id; startStudy(false);}; el.querySelector('.btn-del').onclick=()=>{if(confirm('Supprimer ce set ?')){sets=sets.filter(x=>x.id!==s.id); save(); renderHome();}}; setsGrid.appendChild(el);});}

$('#btnNewSet').onclick=()=>{const s={id:uid(),title:'Nouveau set',subject:'',cards:[]}; upsertSet(s); currentSetId=s.id; showEditor();};
$('#btnBackHome').onclick=showHome; $('#btnBackHome2').onclick=showHome;

function renderEditor(){const s=findSet(currentSetId); if(!s){showHome(); return;} $('#setTitle').value=s.title; $('#setSubject').value=s.subject; cardsList.innerHTML=''; if(!s.cards.length){return;} const tpl=$('#tplCardRow'); s.cards.forEach(c=>{const row=tpl.content.cloneNode(true); const f=row.querySelector('.input-front'); const b=row.querySelector('.input-back'); const img=row.querySelector('.input-img'); const del=row.querySelector('.btn-del-card'); f.value=c.front||''; b.value=c.back||''; img.value=c.img||''; f.addEventListener('input',()=>{c.front=f.value; save();}); b.addEventListener('input',()=>{c.back=b.value; save();}); img.addEventListener('input',()=>{c.img=img.value; save();}); del.onclick=()=>{s.cards=s.cards.filter(x=>x.id!==c.id); upsertSet(s); renderEditor();}; cardsList.appendChild(row);});}
$('#btnAddCard').onclick=()=>{const s=findSet(currentSetId); s.cards.push({id:uid(),front:'',back:'',img:''}); upsertSet(s); renderEditor();};

function startStudy(restartWrong){const s=findSet(currentSetId); if(!s||!s.cards.length){alert('Ajoute des cartes !'); return;} s.title=$('#setTitle').value.trim(); s.subject=$('#setSubject').value.trim(); upsertSet(s); study.order=restartWrong?s.cards.filter(c=>study.wrong.includes(c.id)).map(c=>c.id):s.cards.map(c=>c.id); study.i=0; study.wrong=[]; updateStudyCard(); showStudy();}
function currentCard(){return findSet(currentSetId).cards.find(c=>c.id===study.order[study.i]);}
function updateStudyCard(){const c=currentCard(); if(!c){$('#progressChip').textContent=`${study.order.length}/${study.order.length}`; return;} const el=$('#card'); el.style.backgroundImage=c.img?`url(${c.img})`:'none'; $('#cardText').textContent=`${c.front} - ${c.back}`; $('#progressChip').textContent=`${study.i+1}/${study.order.length}`;}

$('#btnRestartAll').onclick=()=>{startStudy(false);}; $('#btnAgainWrong').onclick=()=>{if(!study.wrong.length){alert('Aucune erreur √† reprendre'); return;} startStudy(true);};

load(); showHome();
</script>
</body>
</html>

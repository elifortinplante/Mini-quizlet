<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Mini Quizlet Final</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body{margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:linear-gradient(135deg,#6366f1,#ec4899,#f59e0b);color:white;min-height:100vh}
.btn{padding:.7rem 1rem;border-radius:9999px;font-weight:700}
.btn-primary{background:linear-gradient(90deg,#6366f1,#ec4899);color:white}
.btn-secondary{background:white;color:#4f46e5;border:2px solid #4f46e5}
.input{width:100%;padding:.6rem .8rem;border-radius:14px;border:2px solid #e5e7eb;background:white;color:black}
.card{width:90vw;max-width:400px;height:60vw;max-height:280px;border-radius:20px;background:white;color:black;position:relative;transform-style:preserve-3d;transition:transform .6s, box-shadow .2s;box-shadow:0 12px 32px rgba(0,0,0,.25);user-select:none;touch-action:none;margin:auto;display:flex;align-items:center;justify-content:center;text-align:center;padding:1rem;}
.card-face{position:absolute;inset:0;backface-visibility:hidden;display:flex;flex-direction:column;justify-content:center;align-items:center;}
.card-front{transform:rotateY(0);}
.card-back{transform:rotateY(180deg);}
.flipped{transform:rotateY(180deg);}
.card img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;border-radius:20px;z-index:-1;}
.text-overlay{position:relative;z-index:1;color:white;font-weight:bold;text-shadow:0 0 5px rgba(0,0,0,.7);font-size:1.1rem;text-align:center;padding:0 0.5rem;}
</style>
</head>
<body class="pb-20">
<header class="max-w-4xl mx-auto px-4 pt-5 flex items-center justify-between">
<div class="flex items-center gap-3">
<div class="w-11 h-11 rounded-2xl bg-white text-indigo-600 grid place-items-center font-extrabold">MQF</div>
<div>
<h1 class="text-2xl font-extrabold drop-shadow">Mini Quizlet Final</h1>
<p class="text-indigo-100 text-sm -mt-1">Étudier en s’amusant ✨</p>
</div>
</div>
<div class="flex items-center gap-2">
<button id="btnNewSet" class="btn btn-primary">+ Nouveau set</button>
</div>
</header>
<main class="max-w-4xl mx-auto px-4 pt-4">
<section id="viewHome" class="space-y-4">
<div id="setsGrid" class="grid grid-cols-1 sm:grid-cols-2 gap-4"></div>
<p id="emptyMsg" class="text-center text-white/90 hidden">Aucun set. Crée ton premier ✨</p>
</section>
<section id="viewEditor" class="hidden">
<div class="flex items-center justify-between mb-3">
<button class="btn btn-secondary" id="btnBackHome1">← Accueil</button>
<button class="btn btn-primary" id="btnStudyFromEditor">▶ Étudier</button>
</div>
<div class="grid sm:grid-cols-2 gap-3 mb-3">
<div>
<label>Titre du set</label>
<input id="setTitle" class="input" placeholder="Titre">
</div>
<div>
<label>Matière</label>
<input id="setSubject" class="input" placeholder="Matière">
</div>
</div>
<div class="flex items-center justify-between mb-2">
<h3 class="font-extrabold">Cartes</h3>
<button id="btnAddCard" class="btn btn-primary">+ Ajouter</button>
</div>
<div id="cardsList" class="space-y-3"></div>
</section>
<section id="viewStudy" class="hidden text-center">
<h2 id="studySetTitle" class="text-xl font-bold mb-1"></h2>
<p id="studySetSubject" class="mb-2 text-sm text-indigo-100"></p>
<div id="progressChip" class="mb-2"></div>
<div id="card" class="card"><div class="card-front card-face"><div id="frontText" class="text-overlay"></div></div><div class="card-back card-face"><div id="backText" class="text-overlay"></div></div><img id="cardImg" src=""></div>
<div class="mt-5 flex flex-wrap items-center justify-center gap-2">
<button id="btnAgainWrong" class="btn btn-secondary">Reprendre erreurs</button>
<button id="btnRestartAll" class="btn btn-primary">Tout recommencer</button>
<button id="btnBackHome2" class="btn btn-secondary">Accueil</button>
</div>
</section>
</main>
<template id="tplSet">
<div class="set-card p-4 flex items-center gap-3 bg-white rounded-2xl text-black">
<div class="flex-1">
<div class="set-title font-bold"></div>
<div class="set-subject text-sm text-gray-500"></div>
<div class="set-count text-xs text-gray-400"></div>
</div>
<div class="flex flex-col gap-2">
<button class="btn btn-primary btn-edit">Modifier</button>
<button class="btn btn-primary btn-play">Jouer</button>
<button class="btn btn-secondary btn-del">Supprimer</button>
</div>
</div>
</template>
<template id="tplCardRow">
<div class="set-card p-3 bg-white rounded-2xl text-black">
<input class="input input-front" placeholder="Question">
<input class="input input-back" placeholder="Réponse">
<input class="input input-img" placeholder="URL image">
<button class="btn btn-secondary btn-del-card">Supprimer</button>
</div>
</template>
<script>
const LS_KEY='mqf_sets';
let sets=[], currentSetId=null, study={order:[],i:0,wrong:[],score:0,finished:false};
const $=(s)=>document.querySelector(s), $all=(s)=>document.querySelectorAll(s);
const uid=()=>Math.random().toString(36).slice(2,9);
function load(){try{sets=JSON.parse(localStorage.getItem(LS_KEY)||'[]');}catch{sets=[]}}function save(){localStorage.setItem(LS_KEY,JSON.stringify(sets));}
function findSet(id){return sets.find(s=>s.id===id)}function upsertSet(s){const i=sets.findIndex(x=>x.id===s.id); i>-1?sets[i]=s:sets.push(s); save();}
function showHome(){$('#viewHome').classList.remove('hidden');$('#viewEditor').classList.add('hidden');$('#viewStudy').classList.add('hidden');renderHome();}
function showEditor(){$('#viewHome').classList.add('hidden');$('#viewEditor').classList.remove('hidden');$('#viewStudy').classList.add('hidden');renderEditor();}
function showStudy(){$('#viewHome').classList.add('hidden');$('#viewEditor').classList.add('hidden');$('#viewStudy').classList.remove('hidden');}
function renderHome(){const grid=$('#setsGrid'); grid.innerHTML=''; if(!sets.length){$('#emptyMsg').classList.remove('hidden');return;}$('#emptyMsg').classList.add('hidden'); const tpl=$('#tplSet'); sets.forEach(s=>{const el=tpl.content.cloneNode(true); el.querySelector('.set-title').textContent=s.title||'Sans titre'; el.querySelector('.set-subject').textContent=s.subject||''; el.querySelector('.set-count').textContent=`${s.cards?.length||0} cartes`; el.querySelector('.btn-edit').onclick=()=>{currentSetId=s.id;showEditor();}; el.querySelector('.btn-play').onclick=()=>{currentSetId=s.id;startStudy(false);}; el.querySelector('.btn-del').onclick=()=>{if(confirm('Supprimer ce set ?')){sets=sets.filter(x=>x.id!==s.id);save();renderHome();}}; grid.appendChild(el);});}
$('#btnNewSet').onclick=()=>{const s={id:uid(),title:'Nouveau set',subject:'',cards:[]}; upsertSet(s); currentSetId=s.id; showEditor();};
function renderEditor(){const s=findSet(currentSetId); if(!s){showHome();return;} $('#setTitle').value=s.title; $('#setSubject').value=s.subject; const list=$('#cardsList'); list.innerHTML=''; if(!s.cards.length) list.innerHTML='<p>Aucune carte</p>'; const tpl=$('#tplCardRow'); s.cards.forEach(c=>{const row=tpl.content.cloneNode(true); const f=row.querySelector('.input-front'); const b=row.querySelector('.input-back'); const img=row.querySelector('.input-img'); const del=row.querySelector('.btn-del-card'); f.value=c.front||''; b.value=c.back||''; img.value=c.img||''; f.addEventListener('input',()=>{c.front=f.value;save();}); b.addEventListener('input',()=>{c.back=b.value;save();}); img.addEventListener('input',()=>{c.img=img.value;save();}); del.onclick=()=>{s.cards=s.cards.filter(x=>x.id!==c.id); upsertSet(s); renderEditor();}; list.appendChild(row);});}
$('#btnAddCard').onclick=()=>{const s=findSet(currentSetId); s.cards.push({id:uid(),front:'',back:'',img:''}); upsertSet(s); renderEditor();};
$('#btnStudyFromEditor').onclick=()=>{const s=findSet(currentSetId); s.title=$('#setTitle').value; s.subject=$('#setSubject').value; upsertSet(s); startStudy(false);};
$('#btnBackHome1').onclick=showHome; $('#btnBackHome2').onclick=showHome;
const cardEl=$('#card'), frontText=$('#frontText'), backText=$('#backText'), cardImg=$('#cardImg');
function startStudy(restartWrong){const s=findSet(currentSetId); if(!s||!s.cards.length){alert('Ajoute des cartes !'); return;} study.order=restartWrong?study.wrong.slice():s.cards.map(c=>c.id); study.i=0; study.wrong=[]; study.score=0; study.finished=false; updateStudyCard(); showStudy();}
function currentCard(){return findSet(currentSetId).cards.find(c=>c.id===study.order[study.i]);}
function updateStudyCard(){const s=findSet(currentSetId); const c=currentCard(); if(!c){study.finished=true; cardEl.style.pointerEvents='none'; return;} frontText.textContent=c.front||''; backText.textContent=c.back||''; cardImg.src=c.img||''; cardEl.classList.remove('flipped'); cardEl.style.pointerEvents='auto'; $('#studySetTitle').textContent=s.title||''; $('#studySetSubject').textContent=s.subject||'';}
cardEl.addEventListener('click',()=>{cardEl.classList.toggle('flipped');});
let startX=0,dragging=false;
cardEl.addEventListener('touchstart',e=>{dragging=true; startX=e.touches[0].clientX;});
cardEl.addEventListener('touchmove',e=>{if(!dragging) return; const dx=e.touches[0].clientX-startX; cardEl.style.transform=`translateX(${dx}px)`;});
cardEl.addEventListener('touchend',e=>{if(!dragging) return; dragging=false; const dx=e.changedTouches[0].clientX-startX; const TH=80; if(dx>TH) markCard(true); else if(dx<-TH) markCard(false); cardEl.style.transform='';});
function markCard(ok){if(study.finished) return; const s=findSet(currentSetId); const c=currentCard(); if(!c) return; if(ok) study.score++; else study.wrong.push(c.id); study.i++; updateStudyCard();}
$('#btnAgainWrong').onclick=()=>{if(!study.wrong.length){alert('Aucune erreur');return;} startStudy(true);};
$('#btnRestartAll').onclick=()=>startStudy(false);
load(); renderHome();
</script>
</body>
</html>
